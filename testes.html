<script>
    const API_URL = "http://localhost:3000"; // Substitua pela URL do backend

    // Exibe a tela de registro
    function mostrarRegistro() {
        document.getElementById("loginBox").style.display = "none";
        document.getElementById("registerBox").style.display = "block";
    }

    // Exibe a tela de login
    function mostrarLogin() {
        document.getElementById("registerBox").style.display = "none";
        document.getElementById("loginBox").style.display = "block";
    }

    // Função para registrar o usuário
    async function registrarUsuario() {
        const matricula = document.getElementById("registroMatricula").value;
        const email = document.getElementById("registroEmail").value;
        const senha = document.getElementById("registroSenha").value;

        if (matricula === "" || email === "" || senha === "") {
            alert("Preencha todos os campos!");
            return;
        }

        try {
            const response = await fetch(`${API_URL}/register`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ matricula, email, senha })
            });

            if (response.ok) {
                alert("Usuário registrado com sucesso!");
                mostrarLogin();
            } else {
                const error = await response.json();
                alert(`Erro: ${error.message}`);
            }
        } catch (error) {
            alert("Erro ao registrar o usuário. Verifique sua conexão.");
            console.error(error);
        }
    }

    // Função para validar o login
    async function validarLogin() {
        const matricula = document.getElementById("matricula").value;
        const email = document.getElementById("email").value;
        const senha = document.getElementById("senha").value;

        if (matricula === "" || email === "" || senha === "") {
            alert("Preencha todos os campos!");
            return;
        }

        try {
            const response = await fetch(`${API_URL}/login`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ matricula, email, senha })
            });

            if (response.ok) {
                alert("Login bem-sucedido!");
                window.location.href = "paginaPrincipal.html"; // Página inicial
            } else {
                const error = await response.json();
                alert(`Erro: ${error.message}`);
            }
        } catch (error) {
            alert("Erro ao realizar login. Verifique sua conexão.");
            console.error(error);
        }
    }
</script>
